{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/observer/array.js","../../src/observer/dep.js","../../src/observer/index.js","../../src/observer/watcher.js","../../src/compiler/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isObject(data) {\r\n  return typeof data === 'object' && data !== null\r\n}\r\n","// 对会改变数组本身的方法进行重写\r\n// 总共7个 push shift unshift pop reverse sort splice\r\n\r\nlet oldArrayMethods = Array.prototype\r\n// value.__proto__ = arrayMethods 原型链向上查找,首先会找到重写的,找不到再向上找到原生的\r\n\r\nexport const arrayMethods = Object.create(oldArrayMethods)\r\n\r\nconst methods = ['push', 'shift', 'unshift', 'pop', 'sort', 'splice', 'reverse']\r\n\r\nmethods.forEach((method) => {\r\n  arrayMethods[method] = function (...args) {\r\n    console.log('用户调用了push方法')\r\n    const result = oldArrayMethods[method].apply(this, args)\r\n    // push unshift添加的元素可能还是对象需要再次监测\r\n    let inserted\r\n    let ob = this.__ob__\r\n    switch (method) {\r\n      case 'push':\r\n      case 'unshift':\r\n        inserted = args\r\n        break\r\n      case 'splice':\r\n        inserted = args.slice(2)\r\n      default:\r\n        break\r\n    }\r\n    if (inserted) ob.observerArray(inserted)\r\n\r\n    return result\r\n  }\r\n})\r\n","export class Dep {\r\n  constructor() {\r\n    this.subs = []\r\n  }\r\n  depend() {\r\n    if (Dep.target) {\r\n      Dep.target.addDep(this)\r\n    }\r\n  }\r\n  addSub(watcher) {\r\n    this.subs.push(watcher)\r\n  }\r\n  notify() {\r\n    this.subs.forEach((sub) => sub.update())\r\n  }\r\n}\r\n\r\n// target其实就是一个watcher的实例\r\n// 在模板编译的时候会 new Watcher(vm, 'c.d', (newVal) => {})\r\nDep.target = null\r\nconst targetStack = []\r\nexport function pushTarget(target) {\r\n  targetStack.push(target)\r\n  Dep.target = target\r\n}\r\nexport function popTarget() {\r\n  targetStack.pop()\r\n  Dep.target = targetStack[targetStack.length - 1]\r\n}\r\n","import { isObject } from '../utils/index.js'\r\nimport { arrayMethods } from './array.js'\r\nimport { Dep } from './dep.js'\r\n\r\nclass Observer {\r\n  constructor(value) {\r\n    // 递归解析对象,对每个对象进行监测\r\n    // 这样性能用有问题,vue3使用proxy直接怼整个进行检测,性能优化了不少\r\n    // value.__ob__ = this // 直接写导致内存溢出,应该是枚举相关问题\r\n    Object.defineProperty(value, '__ob__', this)\r\n\r\n    if (Array.isArray(value)) {\r\n      value.__proto__ = arrayMethods\r\n      // 尤大认为数组每一项的索引都检测会非常损耗性能\r\n      // 直接对数组的7个方法重写监听数组改变\r\n      this.observeArray(value)\r\n    } else {\r\n      this.walk(value)\r\n    }\r\n  }\r\n  observeArray(value) {\r\n    for (let i = 0; i < value.length; i++) {\r\n      observe(value[i])\r\n    }\r\n  }\r\n  walk(data) {\r\n    Object.keys(data).forEach((key) => {\r\n      defineReactive(data, key, data[key])\r\n    })\r\n  }\r\n}\r\n\r\nexport function proxy(vm, data) {\r\n  Object.keys(data).forEach((key) => {\r\n    Object.defineProperty(vm, key, {\r\n      configurable: true,\r\n      enumerable: true,\r\n      get: function () {\r\n        return vm._data[key]\r\n      },\r\n      set: function (newVal) {\r\n        vm._data[key] = newVal\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n  observe(value)\r\n  const dep = new Dep()\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      // 在编译模板会将target设置为watcher的实例,收集依赖\r\n      Dep.target && dep.addSub(Dep.target)\r\n      return value\r\n    },\r\n    set(newVal) {\r\n      if (newVal === value) {\r\n        return\r\n      }\r\n      observe(value)\r\n      console.log('data里的值发生变化了')\r\n      value = newVal\r\n      // 发布更新\r\n      dep.notify()\r\n    }\r\n  })\r\n}\r\n\r\nexport function observe(data) {\r\n  if (!isObject(data)) {\r\n    return\r\n  }\r\n  return new Observer(data)\r\n}\r\n","import { pushTarget, popTarget } from './dep.js'\r\n\r\n// compiler => watcher => getVal执行getter将watcher的实例收集到dep =>\r\n// 每次setter的时候执行dep.notify()执行收集的所有watchers\r\nexport class Watcher {\r\n  constructor(vm, excepssion, cb) {\r\n    this.vm = vm\r\n    this.excepssion = excepssion // eg: person.name, person.age\r\n    this.cb = cb\r\n    this.newDeps = []\r\n    this.value = this.getVal()\r\n    // 执行以下更新，第一次dom取数据渲染的时候\r\n    this.cb(this.value)\r\n  }\r\n  getVal() {\r\n    pushTarget(this)\r\n    let val = this.vm\r\n    // 循环取值\r\n    this.excepssion.split('.').forEach((key) => {\r\n      // 这里每次执行val[key]的时候，就回去执行proxy里面的getter方法\r\n      val = val[key]\r\n    })\r\n    popTarget()\r\n    return val\r\n  }\r\n  addDep(dep) {\r\n    this.newDeps.push(dep)\r\n  }\r\n  update() {\r\n    let arr = this.excepssion.split('.')\r\n    let val = this.vm\r\n    arr.forEach((k) => {\r\n      val = val[k]\r\n    })\r\n    this.cb(val)\r\n  }\r\n}\r\n","import { Watcher } from '../observer/watcher.js'\r\n\r\nexport class Compiler {\r\n  constructor(el, vm) {\r\n    this.init(el, vm)\r\n  }\r\n  init(el, vm) {\r\n    vm.$el = document.querySelector(el)\r\n    // 创建一个文档碎片，这样处理更高效\r\n    let fragment = document.createDocumentFragment()\r\n    let child\r\n    while ((child = vm.$el.firstChild)) {\r\n      fragment.appendChild(child)\r\n    }\r\n    this.replace(fragment, vm)\r\n    vm.$el.appendChild(fragment)\r\n  }\r\n  replace(frag, vm) {\r\n    Array.from(frag.childNodes).forEach((node) => {\r\n      let txt = node.textContent\r\n      let reg = /\\{\\{(.*?)\\}\\}/g // 识别{{xx.xx}}的正则\r\n      if (node.nodeType === 3 && reg.test(txt)) {\r\n        // 文本节点\r\n        // 首次渲染要为数据创建watcher，后面就直接用update更新\r\n        new Watcher(vm, RegExp.$1, (newVal) => {\r\n          // 替换\r\n          node.textContent = txt.replace(reg, newVal).trim()\r\n        })\r\n      } else if (node.nodeType === 1) {\r\n        // 元素节点，这儿只做了v-model双向绑定的情况\r\n        let nodeAttr = node.attributes\r\n        Array.from(nodeAttr).forEach((attr) => {\r\n          let name = attr.name,\r\n            exp = attr.value\r\n          if (name.includes('v-') || name.includes(':')) {\r\n            // 首次渲染要为数据创建watcher，后面就直接用update更新\r\n            new Watcher(vm, exp, (newVal) => {\r\n              node.value = newVal\r\n            })\r\n            node.addEventListener('input', (e) => {\r\n              let newval = e.target.value\r\n              vm[exp] = newval\r\n            })\r\n          }\r\n        })\r\n      }\r\n      if (node.childNodes && node.childNodes.length) {\r\n        this.replace(node, vm)\r\n      }\r\n    })\r\n  }\r\n}\r\n","import { observe, proxy } from './observer/index.js'\r\nimport { Compiler } from './compiler/index.js'\r\n\r\nexport function initState(vm) {\r\n  const opts = vm.$options\r\n\r\n  if (opts.props) {\r\n    initProps(vm)\r\n  }\r\n  if (opts.methods) {\r\n    initMethod(vm)\r\n  }\r\n  if (opts.data) {\r\n    initData(vm)\r\n  }\r\n  if (opts.computed) {\r\n    initComputed(vm)\r\n  }\r\n  if (opts.watch) {\r\n    initWatch(vm)\r\n  }\r\n}\r\n\r\nfunction initProps() {}\r\nfunction initMethod(vm) {\r\n  let methods = vm.$options.methods\r\n  for (const key in methods) {\r\n    vm[key] = methods[key].bind(vm)\r\n  }\r\n}\r\nfunction initData(vm) {\r\n  // console.log('初始化数据', vm)\r\n  // 获取data,data可能是对象或者function\r\n  let data = vm.$options.data\r\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\r\n  // 实现数据代理,让vm.a => vm._data.a\r\n  proxy(vm, data)\r\n  // 对数据劫持,监听数据改变实现MVVM,vue2.x主要用Obejct.defineProperty\r\n  observe(data)\r\n  // 模板编译\r\n  new Compiler(vm.$options.el, vm)\r\n}\r\nfunction initComputed() {}\r\nfunction initWatch() {}\r\n","import { initState } from './state.js'\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    const vm = this\r\n    vm.$options = options\r\n    // 初始化状态\r\n    initState(vm)\r\n  }\r\n}\r\n","import { initMixin } from './init.js'\r\n\r\nfunction Vue(options) {\r\n  this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue\r\n"],"names":["isObject","data","oldArrayMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","console","log","args","result","apply","inserted","ob","__ob__","slice","observerArray","Dep","subs","target","addDep","watcher","push","sub","update","targetStack","pushTarget","popTarget","pop","length","Observer","value","defineProperty","isArray","__proto__","observeArray","walk","i","observe","keys","key","defineReactive","proxy","vm","configurable","enumerable","get","_data","set","newVal","dep","addSub","notify","Watcher","excepssion","cb","newDeps","getVal","val","split","arr","k","Compiler","el","init","$el","document","querySelector","fragment","createDocumentFragment","child","firstChild","appendChild","replace","frag","from","childNodes","node","txt","textContent","reg","nodeType","test","RegExp","$1","trim","nodeAttr","attributes","attr","name","exp","includes","addEventListener","e","newval","initState","opts","$options","props","initMethod","initData","computed","watch","bind","call","initMixin","Vue","_init","options"],"mappings":"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"}